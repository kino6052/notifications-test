<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8" />
  <title>Notification Test - 1:20</title>
</head>

<body>
  <h1>Notification Test</h1>
  <p>This page will send a "Hello World" notification every minute.</p>

  <button id="start">Enable Notifications</button>

  <script>
    // Register service worker
    if ("serviceWorker" in navigator) {
      navigator.serviceWorker.register("sw.js")
        .then(() => console.log("Service worker registered"))
        .catch(err => console.error("SW error:", err));
    }

    document.getElementById("start").onclick = async () => {
      const permission = await Notification.requestPermission();

      if (permission !== "granted") {
        alert("Notifications not allowed");
        return;
      }

      // Wait for service worker to be ready, then send message to start notifications
      const registration = await navigator.serviceWorker.ready;
      registration.active.postMessage({ type: "START_NOTIFICATIONS" });

      alert("Notifications enabled! You will get one every 5 seconds.");
    };
  </script>
</body>

</html>